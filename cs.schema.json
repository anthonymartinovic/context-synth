{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://context-synth.local/cs.schema.json",
  "title": "Context Synth config (cs.yaml)",
  "type": "object",
  "additionalProperties": false,
  "required": ["version", "sources"],
  "properties": {
    "version": { "const": 1 },

    "template": {
      "type": "string",
      "minLength": 1,
      "description": "Workspace path to a custom markdown template. If omitted, Context Synth uses the built-in default template shipped with the extension."
    },

    "sources": {
      "type": "array",
      "minItems": 1,
      "items": { "$ref": "#/definitions/source" }
    },

    "routing": {
      "type": "object",
      "additionalProperties": false,
      "default": { "mode": "heuristic" },
      "properties": {
        "mode": { "type": "string", "enum": ["heuristic", "cursor"], "default": "heuristic" },
        "model": {
          "type": "string",
          "minLength": 1,
          "description": "Preferred editor model name (substring match) when routing.mode=cursor."
        }
      }
    },

    "context": {
      "type": "object",
      "additionalProperties": false,
      "default": { "path": "CONTEXT.md" },
      "properties": {
        "path": {
          "type": "string",
          "minLength": 1,
          "default": "CONTEXT.md",
          "description": "Workspace-relative output path (default: CONTEXT.md)."
        }
      }
    },

    "emit": {
      "type": "object",
      "additionalProperties": false,
      "default": { "citations": true },
      "properties": {
        "citations": { "type": "boolean", "default": true }
      }
    },

    "chunking": {
      "type": "object",
      "additionalProperties": false,
      "default": { "mode": "headings" },
      "properties": {
        "mode": { "type": "string", "enum": ["headings"], "default": "headings" }
      }
    }
  },

  "definitions": {
    "source": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "path"],
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "path": { "type": "string", "minLength": 1 },
        "weight": { "type": "number", "minimum": 0, "maximum": 1, "default": 1.0 }
      }
    }
  }
}
